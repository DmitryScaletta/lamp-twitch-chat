(this["webpackJsonphoney-chat"]=this["webpackJsonphoney-chat"]||[]).push([[0],{159:function(n,t,e){n.exports=e(294)},194:function(n,t){},196:function(n,t){},235:function(n,t){},236:function(n,t){},294:function(n,t,e){"use strict";e.r(t);var r,a=e(0),o=e.n(a),i=e(49),c=e.n(i),s=e(32),u=e(140),l=e(11),f=e(41),d=e.n(f),b=e(61),m=e(91),h=e(298),p=function(n){return t="".concat("https://api.twitch.tv/helix","/users?id=").concat(n),fetch(t,{headers:{Authorization:"Bearer ".concat(localStorage.accessToken)}}).then((function(n){return n.json()}));var t},v=function(n){return fetch("https://recent-messages.robotty.de/api/v2/recent-messages/".concat(n,"?clearchatToNotice=true")).then((function(n){return n.json()}))};function g(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function O(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?g(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):g(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var j=Object(m.a)("SET_IS_AUTH"),y=Object(m.a)("FETCH_USER_REQUEST"),E=Object(m.a)("FETCH_USER_SUCCESS"),w=Object(m.a)("FETCH_USER_FAILURE"),S=Object(h.a)((r={},Object(l.a)(r,j,(function(n,t){var e=t.payload,r=e.isAuth,a=e.user;return O({},n,{isAuth:void 0===r?n.isAuth:r,user:O({},n.user,{},a)})})),Object(l.a)(r,y,(function(n){return O({},n,{isLoading:!0})})),Object(l.a)(r,E,(function(n,t){return O({},n,{isAuth:!0,isLoading:!1,user:t.payload})})),Object(l.a)(r,w,(function(n,t){return O({},n,{isAuth:!1,isLoading:!1,error:t.payload})})),r),{isAuth:!1,isLoading:!1,user:{id:null,login:null,displayName:null}}),k=e(90),_=e(13),x=e(297),A=e(300),T=e(34),P=e(141),R=e(142),C=e(154),I=e(143),D=e(155),L=e(299),N=e(295),H=e(50),M=e(144),U=e.n(M),G=e(145),F=e.n(G);function z(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function J(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?z(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):z(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var V,q=["CAP","001","002","003","004","353","366","375","372","376"],B=["mod","emote-only","r9k","rituals","subs-only","msg-param-should-share-streak"],W=["ban-duration","bits","msg-param-cumulative-months","msg-param-months","msg-param-promo-gift-total","msg-param-streak-months","msg-param-viewerCount","msg-param-threshold"],X=["subscriber","turbo","user-type"],Q=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?n.split(",").reduce((function(n,t){var e=t.split("/"),r=Object(_.a)(e,2),a=r[0],o=r[1];return J({},n,Object(l.a)({},a,o))}),{}):{}},Y=function(n,t){if("emotes"===n)return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?n.split("/").reduce((function(n,t){var e=t.split(":"),r=Object(_.a)(e,2),a=r[0],o=r[1];return J({},n,Object(l.a)({},a,o.split(",").map((function(n){var t=n.split("-"),e=Object(_.a)(t,2),r=e[0],a=e[1];return{start:Number.parseInt(r,10),end:Number.parseInt(a,10)}}))))}),{}):{}}(t);if("badges"===n)return Q(t);if("badge-info"===n)return Q(t);if("followers-only"===n){var e=!1;return"-1"===t?e=!1:"0"===t?e=!0:"string"===typeof t&&(e=parseInt(t,10)),e}if("slow"===n){var r=!1;return"0"===t?r=!1:"string"===typeof t&&(r=parseInt(t,10)),r}return B.includes(n)?"1"===t:W.includes(n)?parseInt(t,10):t},K=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(n).filter((function(n){var t=Object(_.a)(n,1)[0];return!X.includes(t)})).reduce((function(n,t){var e=Object(_.a)(t,2),r=e[0],a=e[1];return J({},n,Object(l.a)({},U()(r),Y(r,a)))}),{})},Z=function(n){return n.startsWith("\x01ACTION ")&&n.endsWith("\x01")},$=function(n){return n.slice(8,-1)},nn=function(n){return n.tags},tn=function(n){function t(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(P.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this))).socket=null,n.channels={},n.options=e||{},n.user=null,n._queue=[],n}return Object(D.a)(t,n),Object(R.a)(t,[{key:"_onConnect",value:function(){var n=this.options.identity,t=n.name,e=n.auth;this.sendRaw(["CAP REQ :twitch.tv/tags twitch.tv/commands","PASS oauth:".concat(e),"NICK ".concat(t)]),this.emit("connected")}},{key:"_onClose",value:function(n){this.emit("disconnected",{willReconnect:!1,hadError:n})}},{key:"_onError",value:function(n){this.emit("error",n)}},{key:"_onData",value:function(n){var t=this;n.trim().split("\r\n").forEach((function(n){return t._handleMessage(n)}))}},{key:"_handleMessage",value:function(n){var t=Object(T.parse)(n);t.raw=n;var e=t.command;if("PING"===e)return this.sendRaw("PONG :tmi.twitch.tv"),void this.emit("ping");if((!t.prefix||"jtv"!==t.prefix.user)&&!q.includes(e)){var r=function(n){var t=n.raw,e=n.command,r=n.tags,a=n.middle,o=n.trailing,i=n.prefix;return{raw:t,command:e,tags:K(r),params:a,message:o,prefix:i}}(t),a=Object(L.a)("",["params",0],r).slice(1);if("PRIVMSG"!==e){if("USERSTATE"===e){var o=function(n){return n.tags}(r);return this.channels[a].userState=o,void this.emit("userstate",o)}if("JOIN"===e)return this.channels=J({},this.channels,Object(l.a)({},a,{})),void this.emit("join",r);if("PART"===e)return this.channels=Object(N.a)([a],this.channels),void this.emit("part",r);if("ROOMSTATE"===e){var i=function(n){return n.tags}(r);return this.channels[a].roomState=i,void this.emit("roomstate",i)}if("GLOBALUSERSTATE"!==e)this.emit("unhandled-command",r);else{var c=nn(r);for(this.user=nn(r);this._queue.length;){var s=this._queue.shift();this.sendRaw(s)}this.emit("globaluserstate",c)}}else this.emit("message",function(n){var t=n.message,e=Z(t);return J({},n,{message:e?$(t):t,isAction:e})}(r))}}},{key:"sendRaw",value:function(n){var t=this,e=function(n){n&&t.emit("error",n)};Array.isArray(n)?n.forEach((function(n){return t.socket.send("".concat(n,"\r\n"),e)})):this.socket.send("".concat(n,"\r\n"),e)}},{key:"connect",value:function(){var n=this;this.socket=new WebSocket("wss://irc-ws.chat.twitch.tv:443");var t=this.socket;t.addEventListener("open",(function(){return n._onConnect()})),t.addEventListener("close",(function(t){return n._onClose(t)})),t.addEventListener("error",(function(t){return n._onError(t)})),t.addEventListener("message",(function(t){return n._onData(t.data)}))}},{key:"say",value:function(n,t){var e=Object(T.format)({command:"PRIVMSG",middle:["#".concat(n)],trailing:t});this.sendRaw(e);var r=t.startsWith("/me "),a=J({},this.channels[n].userState,{id:F()(),roomId:this.channels[n].roomState.roomId,tmiSentTs:(new Date).getTime(),userId:this.user.userId});this.emit("own-message",{command:"PRIVMSG",params:["#".concat(n)],message:r?t.slice(4):t,tags:a,isAction:r})}},{key:"sendCommand",value:function(n,t,e){var r=Array.isArray(e)?e.join(" "):e,a=Object(T.format)({command:"PRIVMSG",middle:["#".concat(n)],trailing:"/".concat(t," ").concat(r)});this.sendRaw(a)}},{key:"join",value:function(n){var t=Object(T.format)({command:"JOIN",middle:["#".concat(n)]});this.user?this.sendRaw(t):this._queue.push(t)}},{key:"part",value:function(n){var t=Object(T.format)({command:"PART",middle:["#".concat(n)]});this.user?this.sendRaw(t):this._queue.push(t)}}]),t}(H.EventEmitter);function en(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function rn(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?en(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):en(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var an=function(n){var t=n.length-500;return t>0?n.slice(t):n},on=Object(x.a)({ADD_MESSAGE:function(n){return[n]},ADD_MESSAGES:function(n){return n}}),cn=on.addMessage,sn=on.addMessages,un=Object(m.a)("FETCH_RECENT_MESSAGES_REQUEST"),ln=Object(m.a)("FETCH_RECENT_MESSAGES_SUCCESS"),fn=Object(m.a)("FETCH_RECENT_MESSAGES_FAILURE"),dn=Object(h.a)((V={},Object(l.a)(V,Object(A.a)(cn,sn),(function(n,t){var e=t.payload;return rn({},n,{items:an([].concat(Object(k.a)(n.items),Object(k.a)(e)))})})),Object(l.a)(V,un,(function(n){return rn({},n,{isLoading:!0})})),Object(l.a)(V,ln,(function(n,t){var e=t.payload;return rn({},n,{isLoading:!1,items:an(e)})})),Object(l.a)(V,fn,(function(n,t){return rn({},n,{isLoading:!1,isError:!0,error:t.payload})})),V),{isLoading:!1,items:[]}),bn=Object(s.c)({auth:S,messages:dn}),mn=e(24),hn=e(51),pn=e(33),vn=e(147),gn=e.n(vn),On=function(){var n=Object(mn.b)(),t=Object(pn.f)();if(!window.location.hash)return null;var e=new URLSearchParams(window.location.hash.slice(1)),r=e.get("access_token"),a=e.get("id_token");if(!r||!a)return null;localStorage.setItem("accessToken",r),localStorage.setItem("idToken",a);var o=gn.a.decode(a).sub;return function(n){return function(){var t=Object(b.a)(d.a.mark((function t(e){var r,a,o,i,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(y()),t.next=3,p(e);case 3:r=t.sent,a=r.data[0],o=a.login,i=a.display_name,c={id:e,login:o,displayName:i},localStorage.setItem("user",JSON.stringify(c)),n(E(c));case 8:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()}(n)(o),t.push("/chat/"),null},jn=e(6),yn=e(296),En=e(7),wn=e(149);function Sn(){var n=Object(jn.a)(["\n  display: block;\n  padding: 10px;\n  width: 100%;\n  height: 38px;\n  max-height: 91px;\n  min-height: 40px;\n  overflow: hidden;\n  border: 2px solid transparent;\n  background-color: #262626;\n  font-family: inherit;\n  line-height: 1.5;\n  border-radius: 4px;\n  outline: none;\n  color: #fff;\n  resize: none;\n  transition-duration: 0.1s;\n  transition-timing-function: ease-in;\n  transition-property: box-shadow, border, background-color;\n\n  &:focus {\n    background-color: #000;\n    border-color: #9147ff;\n  }\n\n  &[disabled] {\n    opacity: 0.5;\n    pointer-events: none;\n  }\n"]);return Sn=function(){return n},n}function kn(){var n=Object(jn.a)(["\n  padding: 0 10px;\n  height: 30px;\n  border: none;\n  color: #fff;\n  background-color: #9147ff;\n  outline: none;\n  font-size: 12px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #772ce8;\n  }\n\n  &:active {\n    background-color: #5c16c5;\n  }\n\n  &:focus {\n    box-shadow: 0 0 6px 0 #772ce8;\n  }\n\n  &[disabled] {\n    background-color: rgba(255, 255, 255, 0.26);\n    color: rgba(255, 255, 255, 0.8);\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]);return kn=function(){return n},n}function _n(){var n=Object(jn.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  align-items: center;\n\n  & > :not(:last-child) {\n    margin-right: 20px;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return _n=function(){return n},n}function xn(){var n=Object(jn.a)(["\n  padding-left: 10px;\n  padding-right: 10px;\n  padding-bottom: 10px;\n  background-color: #000;\n\n  & > :not(:last-child) {\n    margin-bottom: 10px;\n  }\n"]);return xn=function(){return n},n}var An=En.c.form(xn()),Tn=En.c.div(_n()),Pn=En.c.button(kn()),Rn=En.c.textarea(Sn()),Cn=function(n){"Enter"===n.key&&n.preventDefault()},In=function(n){var t=n.isAuth,e=n.isDisabled,r=n.onSubmit,i=Object(a.useRef)(null),c=Object(a.useState)(""),s=Object(_.a)(c,2),u=s[0],l=s[1],f=Object(a.useCallback)((function(n){"Enter"===n.key&&(r(u),l(""))}),[r,l,u]);return Object(a.useEffect)((function(){var n=i.current;return n.addEventListener("keydown",Cn,!1),n.addEventListener("keyup",f,!1),function(){n.removeEventListener("keydown",Cn,!1),n.removeEventListener("keyup",f,!1)}}),[f]),o.a.createElement(An,{onSubmit:function(n){n.preventDefault(),r(u),l("")}},o.a.createElement(Rn,{name:"message",placeholder:"Send a message",ref:i,maxLength:500,disabled:e,onChange:function(n){return l(n.target.value)},value:u}),o.a.createElement(Tn,null,!t&&o.a.createElement(hn.b,{to:"/chat/auth"},"Sign in with Twitch"),o.a.createElement(Pn,{disabled:e,type:"submit"},"Chat")))};In.defaultProps={isDisabled:!1};var Dn=In;function Ln(){var n=Object(jn.a)([""]);return Ln=function(){return n},n}function Nn(){var n=Object(jn.a)(["\n  font-weight: bold;\n  color: ",";\n"]);return Nn=function(){return n},n}function Hn(){var n=Object(jn.a)(["\n  padding: 5px 20px;\n  color: ",";\n  opacity: ",";\n  line-height: 20px;\n  word-wrap: break-word;\n\n  &:nth-child(even) {\n    background-color: #1f1925;\n  }\n\n  .chat-image {\n    display: inline-block;\n    margin: -5px 0;\n    vertical-align: middle;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return Hn=function(){return n},n}var Mn=En.c.div(Hn(),(function(n){return n.isAction?n.color:"#fff"}),(function(n){return n.isHistory?"0.5":"1"})),Un=En.c.span(Nn(),(function(n){return n.color})),Gn=En.c.span(Ln()),Fn=function(n){var t=n.message,e=n.tags,r=e.color,a=e.displayName,i=n.isHistory,c=n.isAction;return o.a.createElement(Mn,{isHistory:i,isAction:c,color:r},o.a.createElement(Un,{color:r},a),!c&&":"," ",o.a.createElement(Gn,{dangerouslySetInnerHTML:{__html:t}}))};Fn.defaultProps={isHistory:!1,isAction:!1};var zn=Fn;function Jn(){var n=Object(jn.a)(["\n  position: absolute;\n  left: 50%;\n  bottom: 10px;\n  display: ",";\n  padding: 5px 20px;\n  background: rgba(0, 0, 0, 0.6);\n  color: #fff;\n  border-radius: 4px;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  transform: translateX(-50%);\n"]);return Jn=function(){return n},n}function Vn(){var n=Object(jn.a)(["\n  overflow-y: auto;\n\n  .ScrollbarsCustom-TrackY {\n    background: none !important;\n  }\n\n  .ScrollbarsCustom-ThumbY {\n    margin-left: auto;\n    margin-right: auto;\n    width: 6px !important;\n  }\n\n  .ScrollbarsCustom-Content {\n    padding-bottom: 10px !important;\n  }\n"]);return Vn=function(){return n},n}function qn(){var n=Object(jn.a)(["\n  position: relative;\n  flex-grow: 1;\n"]);return qn=function(){return n},n}function Bn(){var n=Object(jn.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background-color: #000;\n"]);return Bn=function(){return n},n}function Wn(){var n=Object(jn.a)(["\n  height: 100vh;\n  background-color: #222;\n  font-size: 12px;\n"]);return Wn=function(){return n},n}var Xn=En.c.div(Wn()),Qn=En.c.div(Bn()),Yn=En.c.div(qn()),Kn=Object(En.c)(wn.a).attrs({disableTracksWidthCompensation:!0})(Vn()),Zn=En.c.button(Jn(),(function(n){return n.visible?"block":"none"})),$n=null,nt=function(){var n=Object(mn.b)(),t=Object(a.useState)(!1),e=Object(_.a)(t,2),r=e[0],i=e[1],c=Object(mn.c)((function(n){return n.auth.isAuth})),s=Object(mn.c)((function(n){return n.auth.user.login})),u=Object(mn.c)((function(n){return n.messages.items})),l=Object(a.useState)(!1),f=Object(_.a)(l,2),m=f[0],h=f[1],p=Object(a.useRef)(null),g=function(){p.current&&p.current.scrollToBottom&&p.current.scrollToBottom()};Object(a.useEffect)((function(){m||g()}),[u]);Object(a.useEffect)((function(){!function(n){return function(){var t=Object(b.a)(d.a.mark((function t(e){var r,a,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(un()),t.next=3,v(e);case 3:r=t.sent,a=r.messages,o=a.map((function(n){return Object(T.parse)(n)})).filter((function(n){return"PRIVMSG"===n.command})).map((function(n){var t=n.tags,e=Object(_.a)(n.params,2)[1],r=Z(e);return{tags:K(t),message:r?$(e):e,isAction:r,isHistory:!0}})),n(ln(o));case 7:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()}(n)("nasvay_s")}),[]),Object(a.useEffect)((function(){if($n&&$n.disconnect(),c){var t={identity:{name:s,auth:localStorage.accessToken}};($n=new tn(t)).connect(),$n.join("nasvay_s"),$n.on("connected",(function(){return i(!0)})),$n.on("disconnected",(function(){return i(!1)}));var e=function(t){var e=Object(yn.a)(["tags","message","isAction"],t);n(cn(e))};$n.on("message",e),$n.on("own-message",e)}}),[s]);return o.a.createElement(Xn,null,o.a.createElement(Qn,null,o.a.createElement(Yn,null,o.a.createElement(Kn,{onUpdate:function(n){var t=n.clientHeight,e=n.contentScrollHeight,r=n.scrollTop;h(r+100<e-t)},ref:p},u.map((function(n){var t=n.message,e=n.tags,r=n.isAction,a=n.isHistory;return o.a.createElement(zn,{key:e.id,message:t,tags:e,isAction:r,isHistory:a})}))),o.a.createElement(Zn,{onClick:g,visible:m},"More messages below")),o.a.createElement(Dn,{onSubmit:function(n){$n.say("nasvay_s",n)},isDisabled:!c||!r,isAuth:c})))},tt=function(){var n=Object(mn.b)();return Object(a.useEffect)((function(){if(!window.location.hash){var t=localStorage.getItem("user");if(t){var e=JSON.parse(t);n(j({isAuth:!0,user:e}))}}}),[]),window.location.hash?o.a.createElement(On,null):o.a.createElement(nt,null)},et={client_id:"4e66w1po1tzf645r9vutn9qus05vg9x",redirect_uri:"https://honeykingdom.github.io/chat/",response_type:"token+id_token",scope:["openid","chat:edit","chat:read","user_blocks_read","user_blocks_edit"].join("+"),claims:JSON.stringify({id_token:{email_verified:null,picture:null,preferred_username:null}})},rt=function(){var n=Object.entries(et).map((function(n){var t=Object(_.a)(n,2),e=t[0],r=t[1];return"".concat(e,"=").concat(r)})).join("&");return"".concat("https://id.twitch.tv/oauth2/authorize","?").concat(n)},at=function(){return window.location.href=rt(),null};function ot(){var n=Object(jn.a)(["\n  * {\n    box-sizing: border-box;\n  }\n  body {\n    margin: 0;\n    font-family: Roobert, Helvetica Neue, Helvetica, Arial, sans-serif;\n  }\n"]);return ot=function(){return n},n}var it=Object(En.b)(ot());function ct(){var n=Object(jn.a)([""]);return ct=function(){return n},n}var st=Object(En.b)(ct());function ut(){var n=Object(jn.a)([""]);return ut=function(){return n},n}var lt=Object(En.b)(ut());function ft(){var n=Object(jn.a)(["\n  :root {\n    ",";\n    ",";\n  }\n  ",";\n"]);return ft=function(){return n},n}var dt=Object(En.a)(ft(),st,lt,it),bt=function(n){var t=n.store;return o.a.createElement(o.a.Fragment,null,o.a.createElement(mn.a,{store:t},o.a.createElement(hn.a,null,o.a.createElement(pn.c,null,o.a.createElement(pn.a,{exact:!0,path:"/chat/",component:tt}),o.a.createElement(pn.a,{exact:!0,path:"/chat/auth",component:at})))),o.a.createElement(dt,null))},mt=Object(s.e)(bn,{},Object(s.d)(Object(s.a)(u.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(n){return n}));c.a.render(o.a.createElement(bt,{store:mt}),document.getElementById("root"))}},[[159,1,2]]]);
//# sourceMappingURL=main.4f52855c.chunk.js.map