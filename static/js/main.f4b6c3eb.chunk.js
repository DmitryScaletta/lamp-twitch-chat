(this["webpackJsonphoney-chat"]=this["webpackJsonphoney-chat"]||[]).push([[0],{145:function(n,t,e){n.exports=e(271)},158:function(n,t){},167:function(n,t){},173:function(n,t){},175:function(n,t){},214:function(n,t){},215:function(n,t){},271:function(n,t,e){"use strict";e.r(t);var r,o=e(0),c=e.n(o),a=e(47),i=e.n(a),u=e(29),s=e(133),l=e(19),f=e(38),b=e.n(f),p=e(58),d=e(87),m=e(273),h=function(n){return t="".concat("https://api.twitch.tv/helix","/users?id=").concat(n),fetch(t,{headers:{Authorization:"Bearer ".concat(localStorage.accessToken)}}).then((function(n){return n.json()}));var t};function O(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function g(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?O(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):O(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var v=Object(d.a)("SET_IS_AUTH"),j=Object(d.a)("FETCH_USER_REQUEST"),y=Object(d.a)("FETCH_USER_SUCCESS"),x=Object(d.a)("FETCH_USER_FAILURE"),E=Object(m.a)((r={},Object(l.a)(r,v,(function(n,t){var e=t.payload,r=e.isAuth,o=e.user;return g({},n,{isAuth:void 0===r?n.isAuth:r,user:g({},n.user,{},o)})})),Object(l.a)(r,j,(function(n){return g({},n,{isLoading:!0})})),Object(l.a)(r,y,(function(n,t){return g({},n,{isAuth:!0,isLoading:!1,user:t.payload})})),Object(l.a)(r,x,(function(n,t){return g({},n,{isAuth:!1,isLoading:!1,error:t.payload})})),r),{isAuth:!1,isLoading:!1,user:{id:null,login:null,displayName:null}}),w=e(33),S=e(272),k=e(274);function _(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}var P=Object(S.a)({ADD_MESSAGE:function(n){return{messages:[n]}},ADD_MESSAGES:function(n){return{messages:n}}}),D=P.addMessage,T=P.addMessages,A=Object(m.a)(Object(l.a)({},Object(k.a)(D,T),(function(n,t){var e=t.payload.messages;return function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?_(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):_(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}({},n,{items:[].concat(Object(w.a)(n.items),Object(w.a)(e))})})),{items:[]}),H=Object(u.c)({auth:E,messages:A}),C=e(25),I=e(48),L=e(30),N=e(14),R=e(5),U=e(6),z=e(135),M=e(81),F=e.n(M),J=e(136);function X(){var n=Object(R.a)(["\n  display: block;\n  padding: 10px;\n  width: 100%;\n  height: 38px;\n  max-height: 91px;\n  min-height: 40px;\n  overflow: hidden;\n  border: 2px solid transparent;\n  background-color: #262626;\n  font-family: inherit;\n  line-height: 1.5;\n  border-radius: 4px;\n  outline: none;\n  color: #fff;\n  resize: none;\n  transition-duration: 0.1s;\n  transition-timing-function: ease-in;\n  transition-property: box-shadow, border, background-color;\n\n  &:focus {\n    background-color: #000;\n    border-color: #9147ff;\n  }\n\n  &[disabled] {\n    opacity: 0.5;\n    pointer-events: none;\n  }\n"]);return X=function(){return n},n}function B(){var n=Object(R.a)(["\n  padding: 0 10px;\n  height: 30px;\n  border: none;\n  color: #fff;\n  background-color: #9147ff;\n  outline: none;\n  font-size: 12px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #772ce8;\n  }\n\n  &:active {\n    background-color: #5c16c5;\n  }\n\n  &:focus {\n    box-shadow: 0 0 6px 0 #772ce8;\n  }\n\n  &[disabled] {\n    background-color: rgba(255, 255, 255, 0.26);\n    color: rgba(255, 255, 255, 0.8);\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]);return B=function(){return n},n}function G(){var n=Object(R.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  align-items: center;\n\n  & > :not(:last-child) {\n    margin-right: 20px;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return G=function(){return n},n}function V(){var n=Object(R.a)(["\n  padding-left: 10px;\n  padding-right: 10px;\n  padding-bottom: 10px;\n  background-color: #000;\n\n  & > :not(:last-child) {\n    margin-bottom: 10px;\n  }\n"]);return V=function(){return n},n}var q=U.c.form(V()),Y=U.c.div(G()),Q=U.c.button(B()),W=U.c.textarea(X()),K=function(n){var t=n.isAuth,e=n.isDisabled,r=n.onSubmit,a=Object(o.useRef)(null),i=Object(o.useState)(""),u=Object(N.a)(i,2),s=u[0],l=u[1],f=Object(o.useCallback)((function(n){"Enter"===n.key&&(r(s),l(""))}),[r,l,s]);return Object(o.useEffect)((function(){var n=a.current;return n.addEventListener("keyup",f,!1),function(){return n.removeEventListener("keyup",f,!1)}}),[f]),c.a.createElement(q,{onSubmit:function(n){n.preventDefault(),r(s),l("")}},c.a.createElement(W,{name:"message",placeholder:"Send a message",ref:a,maxLength:500,disabled:e,onChange:function(n){return l(n.target.value)},value:s}),c.a.createElement(Y,null,!t&&c.a.createElement(I.b,{to:"/chat/auth"},"Sign in with Twitch"),c.a.createElement(Q,{disabled:e,type:"submit"},"Chat")))};K.defaultProps={isDisabled:!1};var Z=K,$=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,e=n.split("");return Object.entries(t||{}).forEach((function(n){var t=Object(N.a)(n,2),r=t[0];t[1].forEach((function(n){if("string"===typeof n){var t=n.split("-").map(Number),o=Object(N.a)(t,2),c=o[0],a=o[1],i=a-c,u=Object(w.a)(Array(i+1)).map((function(){return""}));(e=e.slice(0,c).concat(u).concat(e.slice(a+1,e.length))).splice(c,1,'<img class="chat-image" src="https://static-cdn.jtvnw.net/emoticons/v1/'.concat(r,'/1.0" srcset="https://static-cdn.jtvnw.net/emoticons/v1/').concat(r,"/1.0 1x,https://static-cdn.jtvnw.net/emoticons/v1/").concat(r,"/2.0 2x,https://static-cdn.jtvnw.net/emoticons/v1/").concat(r,'/3.0 4x">'))}}))})),e.join("")};function nn(){var n=Object(R.a)([""]);return nn=function(){return n},n}function tn(){var n=Object(R.a)(["\n  font-weight: bold;\n  color: ",";\n"]);return tn=function(){return n},n}function en(){var n=Object(R.a)(["\n  padding: 5px 20px;\n  color: #fff;\n  opacity: ",";\n  line-height: 20px;\n  word-wrap: break-word;\n\n  &:nth-child(even) {\n    background-color: #1f1925;\n  }\n\n  .chat-image {\n    display: inline-block;\n    margin: -5px 0;\n    vertical-align: middle;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return en=function(){return n},n}var rn=U.c.div(en(),(function(n){return n.isHistory?"0.5":"1"})),on=U.c.span(tn(),(function(n){return n.color})),cn=U.c.span(nn()),an=function(n){var t=n.name,e=n.color,r=n.text,o=n.emotes,a=n.isHistory;return c.a.createElement(rn,{isHistory:a},c.a.createElement(on,{color:e},t),":"," ",c.a.createElement(cn,{dangerouslySetInnerHTML:{__html:$(r,o)}}))};an.defaultProps={emotes:{},isHistory:!1};var un=an;function sn(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function ln(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?sn(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):sn(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function fn(){var n=Object(R.a)(["\n  position: absolute;\n  right: 0;\n  bottom: 10px;\n  display: ",";\n  padding: 5px 20px;\n  background: rgba(0, 0, 0, 0.6);\n  color: #fff;\n  border-radius: 4px;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  transform: translateX(-50%);\n"]);return fn=function(){return n},n}function bn(){var n=Object(R.a)(["\n  overflow-y: auto;\n\n  .ScrollbarsCustom-TrackY {\n    background: none !important;\n  }\n\n  .ScrollbarsCustom-ThumbY {\n    margin-left: auto;\n    margin-right: auto;\n    width: 6px !important;\n  }\n\n  .ScrollbarsCustom-Content {\n    padding-bottom: 10px !important;\n  }\n"]);return bn=function(){return n},n}function pn(){var n=Object(R.a)(["\n  position: relative;\n  flex-grow: 1;\n"]);return pn=function(){return n},n}function dn(){var n=Object(R.a)(["\n  display: flex;\n  flex-direction: column;\n  width: 340px;\n  height: 100%;\n  background-color: #000;\n"]);return dn=function(){return n},n}function mn(){var n=Object(R.a)(["\n  height: 100vh;\n  background-color: #222;\n  font-size: 12px;\n"]);return mn=function(){return n},n}var hn=U.c.div(mn()),On=U.c.div(dn()),gn=U.c.div(pn()),vn=Object(U.c)(J.a).attrs({disableTracksWidthCompensation:!0})(bn()),jn=U.c.button(fn(),(function(n){return n.visible?"block":"none"})),yn={options:{clientId:"4e66w1po1tzf645r9vutn9qus05vg9x"},connection:{secure:!0,reconnect:!0},channels:["nasvay_s"]},xn=function(n){return"string"!==typeof n?n:n.split("/").reduce((function(n,t){var e=t.split(":"),r=Object(N.a)(e,2),o=r[0],c=r[1];return ln({},n,Object(l.a)({},o,c.split(",")))}),{})},En=null,wn=function(){var n=Object(o.useState)([]),t=Object(N.a)(n,2),e=t[0],r=t[1],a=Object(o.useState)(!1),i=Object(N.a)(a,2),u=i[0],s=i[1],l=Object(C.c)((function(n){return n.auth.isAuth})),f=Object(C.c)((function(n){return n.auth.user.login})),d=Object(o.useState)(!1),m=Object(N.a)(d,2),h=m[0],O=m[1],g=Object(o.useRef)(null),v=function(){g.current&&g.current.scrollToBottom&&g.current.scrollToBottom()};Object(o.useEffect)(v,[e]);Object(o.useEffect)((function(){(function(){var n=Object(p.a)(b.a.mark((function n(){var t,e,o;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://recent-messages.robotty.de/api/v2/recent-messages/".concat("nasvay_s","?clearchatToNotice=true"));case 2:return t=n.sent,n.next=5,t.json();case 5:e=n.sent,o=e.messages.map((function(n){return F.a.msg(n)})).filter((function(n){return"PRIVMSG"===n.command})).map((function(n){var t=Object(N.a)(n.params,2)[1],e=n.tags,r=e["display-name"],o=e.color,c=e.emotes;return{name:r,color:o,text:t,emotes:xn(c),isHistory:!0}})),r(o);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[]),Object(o.useEffect)((function(){if(En&&En.disconnect(),l){var n=function(){var n=l?{identity:{username:f,password:"oauth:".concat(localStorage.accessToken)}}:{};return ln({},yn,{},n)}();(En=new z.Client(n)).connect(),En.on("connected",(function(){return s(!0)})),En.on("disconnected",(function(){return s(!1)})),En.on("message",(function(n,t,e){var o=t.color,c=t["display-name"],a=t.emotes,i={name:c,color:o,emotes:xn(a),text:e};r((function(n){return[].concat(Object(w.a)(n),[i])}))}))}}),[f]);return c.a.createElement(hn,null,c.a.createElement(On,null,c.a.createElement(gn,null,c.a.createElement(vn,{onUpdate:function(n){var t=n.clientHeight,e=n.contentScrollHeight,r=n.scrollTop;O(r+100<e-t)},ref:g},e.map((function(n,t){var e=n.name,r=n.color,o=n.text,a=n.emotes,i=n.isHistory;return c.a.createElement(un,{key:t,name:e,color:r,text:o,emotes:a,isHistory:i})}))),c.a.createElement(jn,{onClick:v,visible:h},"More messages below")),c.a.createElement(Z,{onSubmit:function(n){En.say("nasvay_s",n)},isDisabled:!l||!u,isAuth:l})))},Sn=function(){var n=Object(C.b)();return Object(o.useEffect)((function(){var t=localStorage.getItem("user");if(t){var e=JSON.parse(t);n(v({isAuth:!0,user:e}))}}),[]),c.a.createElement(wn,null)},kn={client_id:"4e66w1po1tzf645r9vutn9qus05vg9x",redirect_uri:"https://honeykingdom.github.io/chat/auth-callback",response_type:"token+id_token",scope:["openid","chat:edit","chat:read","user_blocks_read","user_blocks_edit"].join("+"),claims:JSON.stringify({id_token:{email_verified:null,picture:null,preferred_username:null}})},_n=function(){var n=Object.entries(kn).map((function(n){var t=Object(N.a)(n,2),e=t[0],r=t[1];return"".concat(e,"=").concat(r)})).join("&");return"".concat("https://id.twitch.tv/oauth2/authorize","?").concat(n)},Pn=function(){return window.location.href=_n(),null},Dn=e(142),Tn=e.n(Dn),An=function(){var n=Object(C.b)(),t=Object(L.f)();if(!window.location.hash)return null;var e=new URLSearchParams(window.location.hash.slice(1)),r=e.get("access_token"),o=e.get("id_token");if(!r||!o)return null;localStorage.setItem("accessToken",r),localStorage.setItem("idToken",o);var c=Tn.a.decode(o).sub;return function(n){return function(){var t=Object(p.a)(b.a.mark((function t(e){var r,o,c,a,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(j()),t.next=3,h(e);case 3:r=t.sent,o=r.data[0],c=o.login,a=o.display_name,i={id:e,login:c,displayName:a},localStorage.setItem("user",JSON.stringify(i)),n(y(i));case 8:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()}(n)(c),t.push("/"),null};function Hn(){var n=Object(R.a)(["\n  * {\n    box-sizing: border-box;\n  }\n  body {\n    margin: 0;\n    font-family: Roobert, Helvetica Neue, Helvetica, Arial, sans-serif;\n  }\n"]);return Hn=function(){return n},n}var Cn=Object(U.b)(Hn());function In(){var n=Object(R.a)([""]);return In=function(){return n},n}var Ln=Object(U.b)(In());function Nn(){var n=Object(R.a)([""]);return Nn=function(){return n},n}var Rn=Object(U.b)(Nn());function Un(){var n=Object(R.a)(["\n  :root {\n    ",";\n    ",";\n  }\n  ",";\n"]);return Un=function(){return n},n}var zn=Object(U.a)(Un(),Ln,Rn,Cn),Mn=function(n){var t=n.store;return c.a.createElement(c.a.Fragment,null,c.a.createElement(C.a,{store:t},c.a.createElement(I.a,null,c.a.createElement(L.c,null,c.a.createElement(L.a,{exact:!0,path:"/chat/",component:Sn}),c.a.createElement(L.a,{exact:!0,path:"/chat/auth",component:Pn}),c.a.createElement(L.a,{exact:!0,path:"/chat/auth-callback",component:An})))),c.a.createElement(zn,null))},Fn=Object(u.e)(H,{},Object(u.d)(Object(u.a)(s.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(n){return n}));i.a.render(c.a.createElement(Mn,{store:Fn}),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.f4b6c3eb.chunk.js.map