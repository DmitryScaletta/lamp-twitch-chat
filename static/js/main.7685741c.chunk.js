(this["webpackJsonphoney-chat"]=this["webpackJsonphoney-chat"]||[]).push([[0],{155:function(n,t,e){n.exports=e(290)},188:function(n,t){},190:function(n,t){},229:function(n,t){},230:function(n,t){},290:function(n,t,e){"use strict";e.r(t);var r,a=e(0),o=e.n(a),c=e(46),i=e.n(c),u=e(29),s=e(137),l=e(10),f=e(38),d=e.n(f),b=e(58),p=e(88),m=e(292),h=function(n){return t="".concat("https://api.twitch.tv/helix","/users?id=").concat(n),fetch(t,{headers:{Authorization:"Bearer ".concat(localStorage.accessToken)}}).then((function(n){return n.json()}));var t},v=function(n){return fetch("https://recent-messages.robotty.de/api/v2/recent-messages/".concat(n,"?clearchatToNotice=true")).then((function(n){return n.json()}))};function O(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function g(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?O(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):O(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var j=Object(p.a)("SET_IS_AUTH"),y=Object(p.a)("FETCH_USER_REQUEST"),E=Object(p.a)("FETCH_USER_SUCCESS"),w=Object(p.a)("FETCH_USER_FAILURE"),S=Object(m.a)((r={},Object(l.a)(r,j,(function(n,t){var e=t.payload,r=e.isAuth,a=e.user;return g({},n,{isAuth:void 0===r?n.isAuth:r,user:g({},n.user,{},a)})})),Object(l.a)(r,y,(function(n){return g({},n,{isLoading:!0})})),Object(l.a)(r,E,(function(n,t){return g({},n,{isAuth:!0,isLoading:!1,user:t.payload})})),Object(l.a)(r,w,(function(n,t){return g({},n,{isAuth:!1,isLoading:!1,error:t.payload})})),r),{isAuth:!1,isLoading:!1,user:{id:null,login:null,displayName:null}}),_=e(87),k=e(11),x=e(291),A=e(293),T=e(31),P=e(138),R=e(139),C=e(151),D=e(140),I=e(152),N=e(47),L=e(141),H=e.n(L);function M(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function U(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?M(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):M(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var G,F=["CAP","001","002","003","004","353","366","375","372","376"],z=["mod","emote-only","r9k","rituals","subs-only","msg-param-should-share-streak"],J=["ban-duration","bits","msg-param-cumulative-months","msg-param-months","msg-param-promo-gift-total","msg-param-streak-months","msg-param-viewerCount","msg-param-threshold"],q=["subscriber","turbo","user-type"],V=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?n.split(",").reduce((function(n,t){var e=t.split("/"),r=Object(k.a)(e,2),a=r[0],o=r[1];return U({},n,Object(l.a)({},a,o))}),{}):{}},B=function(n,t){if("emotes"===n)return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return n?n.split("/").reduce((function(n,t){var e=t.split(":"),r=Object(k.a)(e,2),a=r[0],o=r[1];return U({},n,Object(l.a)({},a,o.split(",").map((function(n){var t=n.split("-"),e=Object(k.a)(t,2),r=e[0],a=e[1];return{start:Number.parseInt(r,10),end:Number.parseInt(a,10)}}))))}),{}):{}}(t);if("badges"===n)return V(t);if("badge-info"===n)return V(t);if("followers-only"===n){var e=!1;return"-1"===t?e=!1:"0"===t?e=!0:"string"===typeof t&&(e=parseInt(t,10)),e}if("slow"===n){var r=!1;return"0"===t?r=!1:"string"===typeof t&&(r=parseInt(t,10)),r}return z.includes(n)?"1"===t:J.includes(n)?parseInt(t,10):t},X=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(n).filter((function(n){var t=Object(k.a)(n,1)[0];return!q.includes(t)})).reduce((function(n,t){var e=Object(k.a)(t,2),r=e[0],a=e[1];return U({},n,Object(l.a)({},H()(r),B(r,a)))}),{})},W=function(n){return n.startsWith("\x01ACTION ")&&n.endsWith("\x01")},Q=function(n){return n.slice(8,-1)},Y=function(n){function t(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(P.a)(this,t),(n=Object(C.a)(this,Object(D.a)(t).call(this))).socket=null,n.channels=[],n.options=e||{},n.user=null,n._queue=[],n}return Object(I.a)(t,n),Object(R.a)(t,[{key:"_onConnect",value:function(){var n=this.options.identity,t=n.name,e=n.auth;this.sendRaw(["CAP REQ :twitch.tv/tags twitch.tv/commands","PASS oauth:".concat(e),"NICK ".concat(t)]),this.emit("connected")}},{key:"_onClose",value:function(n){this.emit("disconnected",{willReconnect:!1,hadError:n})}},{key:"_onError",value:function(n){this.emit("error",n)}},{key:"_onData",value:function(n){var t=this;n.trim().split("\r\n").forEach((function(n){return t._handleMessage(n)}))}},{key:"_handleMessage",value:function(n){var t=Object(T.parse)(n);t.raw=n;var e=t.command;if("PING"===e)return this.sendRaw("PONG :tmi.twitch.tv"),void this.emit("ping");if((!t.prefix||"jtv"!==t.prefix.user)&&!F.includes(e)){var r=function(n){var t=n.raw,e=n.command,r=n.tags,a=n.middle,o=n.trailing,c=n.prefix;return{raw:t,command:e,tags:X(r),params:a,message:o,prefix:c}}(t);if("PRIVMSG"!==e)if("USERSTATE"!==e)if("JOIN"!==e)if("PART"!==e)if("ROOMSTATE"!==e)if("GLOBALUSERSTATE"!==e)this.emit("unhandled-command",r);else{for(this.user=r;this._queue.length;){var a=this._queue.shift();this.sendRaw(a)}this.emit("globaluserstate",{data:r})}else this.emit("roomstate",r);else this.emit("part",r);else this.emit("join",r);else this.emit("userstate",r);else this.emit("message",r)}}},{key:"sendRaw",value:function(n){var t=this,e=function(n){n&&t.emit("error",n)};Array.isArray(n)?n.forEach((function(n){return t.socket.send("".concat(n,"\r\n"),e)})):this.socket.send("".concat(n,"\r\n"),e)}},{key:"connect",value:function(){var n=this;this.socket=new WebSocket("wss://irc-ws.chat.twitch.tv:443");var t=this.socket;t.addEventListener("open",(function(){return n._onConnect()})),t.addEventListener("close",(function(t){return n._onClose(t)})),t.addEventListener("error",(function(t){return n._onError(t)})),t.addEventListener("message",(function(t){return n._onData(t.data)}))}},{key:"say",value:function(n,t){var e=Object(T.format)({command:"PRIVMSG",middle:[n],trailing:t});this.sendRaw(e)}},{key:"sendCommand",value:function(n,t,e){var r=Array.isArray(e)?e.join(" "):e,a=Object(T.format)({command:"PRIVMSG",middle:[n],trailing:"/".concat(t," ").concat(r)});this.sendRaw(a)}},{key:"join",value:function(n){var t=Object(T.format)({command:"JOIN",middle:[n]});this.user?this.sendRaw(t):this._queue.push(t)}},{key:"part",value:function(n){var t=Object(T.format)({command:"PART",middle:[n]});this.user?this.sendRaw(t):this._queue.push(t)}}]),t}(N.EventEmitter);function K(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function Z(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?K(e,!0).forEach((function(t){Object(l.a)(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):K(e).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}var $=function(n){var t=n.length-500;return t>0?n.slice(t):n},nn=Object(x.a)({ADD_MESSAGE:function(n){return[n]},ADD_MESSAGES:function(n){return n}}),tn=nn.addMessage,en=nn.addMessages,rn=Object(p.a)("FETCH_RECENT_MESSAGES_REQUEST"),an=Object(p.a)("FETCH_RECENT_MESSAGES_SUCCESS"),on=Object(p.a)("FETCH_RECENT_MESSAGES_FAILURE"),cn=Object(m.a)((G={},Object(l.a)(G,Object(A.a)(tn,en),(function(n,t){var e=t.payload;return Z({},n,{items:$([].concat(Object(_.a)(n.items),Object(_.a)(e)))})})),Object(l.a)(G,rn,(function(n){return Z({},n,{isLoading:!0})})),Object(l.a)(G,an,(function(n,t){var e=t.payload;return Z({},n,{isLoading:!1,items:$(e)})})),Object(l.a)(G,on,(function(n,t){return Z({},n,{isLoading:!1,isError:!0,error:t.payload})})),G),{isLoading:!1,items:[]}),un=Object(u.c)({auth:S,messages:cn}),sn=e(20),ln=e(48),fn=e(30),dn=e(143),bn=e.n(dn),pn=function(){var n=Object(sn.b)(),t=Object(fn.f)();if(!window.location.hash)return null;var e=new URLSearchParams(window.location.hash.slice(1)),r=e.get("access_token"),a=e.get("id_token");if(!r||!a)return null;localStorage.setItem("accessToken",r),localStorage.setItem("idToken",a);var o=bn.a.decode(a).sub;return function(n){return function(){var t=Object(b.a)(d.a.mark((function t(e){var r,a,o,c,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(y()),t.next=3,h(e);case 3:r=t.sent,a=r.data[0],o=a.login,c=a.display_name,i={id:e,login:o,displayName:c},localStorage.setItem("user",JSON.stringify(i)),n(E(i));case 8:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()}(n)(o),t.push("/chat/"),null},mn=e(5),hn=e(6),vn=e(145),On=e(147),gn=e.n(On);function jn(){var n=Object(mn.a)(["\n  display: block;\n  padding: 10px;\n  width: 100%;\n  height: 38px;\n  max-height: 91px;\n  min-height: 40px;\n  overflow: hidden;\n  border: 2px solid transparent;\n  background-color: #262626;\n  font-family: inherit;\n  line-height: 1.5;\n  border-radius: 4px;\n  outline: none;\n  color: #fff;\n  resize: none;\n  transition-duration: 0.1s;\n  transition-timing-function: ease-in;\n  transition-property: box-shadow, border, background-color;\n\n  &:focus {\n    background-color: #000;\n    border-color: #9147ff;\n  }\n\n  &[disabled] {\n    opacity: 0.5;\n    pointer-events: none;\n  }\n"]);return jn=function(){return n},n}function yn(){var n=Object(mn.a)(["\n  padding: 0 10px;\n  height: 30px;\n  border: none;\n  color: #fff;\n  background-color: #9147ff;\n  outline: none;\n  font-size: 12px;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &:hover {\n    background-color: #772ce8;\n  }\n\n  &:active {\n    background-color: #5c16c5;\n  }\n\n  &:focus {\n    box-shadow: 0 0 6px 0 #772ce8;\n  }\n\n  &[disabled] {\n    background-color: rgba(255, 255, 255, 0.26);\n    color: rgba(255, 255, 255, 0.8);\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n"]);return yn=function(){return n},n}function En(){var n=Object(mn.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  align-items: center;\n\n  & > :not(:last-child) {\n    margin-right: 20px;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return En=function(){return n},n}function wn(){var n=Object(mn.a)(["\n  padding-left: 10px;\n  padding-right: 10px;\n  padding-bottom: 10px;\n  background-color: #000;\n\n  & > :not(:last-child) {\n    margin-bottom: 10px;\n  }\n"]);return wn=function(){return n},n}var Sn=hn.c.form(wn()),_n=hn.c.div(En()),kn=hn.c.button(yn()),xn=hn.c.textarea(jn()),An=function(n){var t=n.isAuth,e=n.isDisabled,r=n.onSubmit,c=Object(a.useRef)(null),i=Object(a.useState)(""),u=Object(k.a)(i,2),s=u[0],l=u[1],f=Object(a.useCallback)((function(n){"Enter"===n.key&&(r(s),l(""))}),[r,l,s]);return Object(a.useEffect)((function(){var n=c.current;return n.addEventListener("keyup",f,!1),function(){return n.removeEventListener("keyup",f,!1)}}),[f]),o.a.createElement(Sn,{onSubmit:function(n){n.preventDefault(),r(s),l("")}},o.a.createElement(xn,{name:"message",placeholder:"Send a message",ref:c,maxLength:500,disabled:e,onChange:function(n){return l(n.target.value)},value:s}),o.a.createElement(_n,null,!t&&o.a.createElement(ln.b,{to:"/chat/auth"},"Sign in with Twitch"),o.a.createElement(kn,{disabled:e,type:"submit"},"Chat")))};An.defaultProps={isDisabled:!1};var Tn=An;function Pn(){var n=Object(mn.a)([""]);return Pn=function(){return n},n}function Rn(){var n=Object(mn.a)(["\n  font-weight: bold;\n  color: ",";\n"]);return Rn=function(){return n},n}function Cn(){var n=Object(mn.a)(["\n  padding: 5px 20px;\n  color: ",";\n  opacity: ",";\n  line-height: 20px;\n  word-wrap: break-word;\n\n  &:nth-child(even) {\n    background-color: #1f1925;\n  }\n\n  .chat-image {\n    display: inline-block;\n    margin: -5px 0;\n    vertical-align: middle;\n  }\n\n  a {\n    color: #bf94ff;\n    text-decoration: none;\n\n    &:focus,\n    &:hover {\n      color: #a970ff;\n      text-decoration: underline;\n    }\n\n    &:visited {\n      color: #a970ff;\n    }\n  }\n"]);return Cn=function(){return n},n}var Dn=hn.c.div(Cn(),(function(n){return n.isAction?n.color:"#fff"}),(function(n){return n.isHistory?"0.5":"1"})),In=hn.c.span(Rn(),(function(n){return n.color})),Nn=hn.c.span(Pn()),Ln=function(n){var t=n.message,e=n.tags,r=e.color,a=e.displayName,c=n.isHistory,i=n.isAction;return o.a.createElement(Dn,{isHistory:c,isAction:i,color:r},o.a.createElement(In,{color:r},a),!i&&":"," ",o.a.createElement(Nn,{dangerouslySetInnerHTML:{__html:t}}))};Ln.defaultProps={isHistory:!1,isAction:!1};var Hn=Ln;function Mn(){var n=Object(mn.a)(["\n  position: absolute;\n  left: 50%;\n  bottom: 10px;\n  display: ",";\n  padding: 5px 20px;\n  background: rgba(0, 0, 0, 0.6);\n  color: #fff;\n  border-radius: 4px;\n  border: none;\n  outline: none;\n  cursor: pointer;\n  transform: translateX(-50%);\n"]);return Mn=function(){return n},n}function Un(){var n=Object(mn.a)(["\n  overflow-y: auto;\n\n  .ScrollbarsCustom-TrackY {\n    background: none !important;\n  }\n\n  .ScrollbarsCustom-ThumbY {\n    margin-left: auto;\n    margin-right: auto;\n    width: 6px !important;\n  }\n\n  .ScrollbarsCustom-Content {\n    padding-bottom: 10px !important;\n  }\n"]);return Un=function(){return n},n}function Gn(){var n=Object(mn.a)(["\n  position: relative;\n  flex-grow: 1;\n"]);return Gn=function(){return n},n}function Fn(){var n=Object(mn.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background-color: #000;\n"]);return Fn=function(){return n},n}function zn(){var n=Object(mn.a)(["\n  height: 100vh;\n  background-color: #222;\n  font-size: 12px;\n"]);return zn=function(){return n},n}var Jn=hn.c.div(zn()),qn=hn.c.div(Fn()),Vn=hn.c.div(Gn()),Bn=Object(hn.c)(vn.a).attrs({disableTracksWidthCompensation:!0})(Un()),Xn=hn.c.button(Mn(),(function(n){return n.visible?"block":"none"})),Wn=null,Qn=function(){var n=Object(sn.b)(),t=Object(a.useState)(!1),e=Object(k.a)(t,2),r=e[0],c=e[1],i=Object(sn.c)((function(n){return n.auth.isAuth})),u=Object(sn.c)((function(n){return n.auth.user.login})),s=Object(sn.c)((function(n){return n.auth.user.displayName})),l=Object(sn.c)((function(n){return n.messages.items})),f=Object(a.useState)(""),p=Object(k.a)(f,2),m=p[0],h=p[1],O=Object(a.useState)(!1),g=Object(k.a)(O,2),j=g[0],y=g[1],E=Object(a.useRef)(null),w=function(){E.current&&E.current.scrollToBottom&&E.current.scrollToBottom()};Object(a.useEffect)((function(){j||w()}),[l]);Object(a.useEffect)((function(){!function(n){return function(){var t=Object(b.a)(d.a.mark((function t(e){var r,a,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(rn()),t.next=3,v(e);case 3:r=t.sent,a=r.messages,o=a.map((function(n){return Object(T.parse)(n)})).filter((function(n){return"PRIVMSG"===n.command})).map((function(n){var t=n.tags,e=Object(k.a)(n.params,2)[1],r=W(e);return{tags:X(t),message:r?Q(e):e,isAction:r,isHistory:!0}})),n(an(o));case 7:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}()}(n)("nasvay_s")}),[]),Object(a.useEffect)((function(){if(Wn&&Wn.disconnect(),i){var t={identity:{name:u,auth:localStorage.accessToken}};(Wn=new Y(t)).connect(),Wn.join("#".concat("nasvay_s")),Wn.on("connected",(function(){return c(!0)})),Wn.on("disconnected",(function(){return c(!1)})),Wn.on("message",(function(t){return n(tn(t))})),Wn.on("userstate",(function(n){var t=n.tags;return h(t.color)}))}}),[u]);return o.a.createElement(Jn,null,o.a.createElement(qn,null,o.a.createElement(Vn,null,o.a.createElement(Bn,{onUpdate:function(n){var t=n.clientHeight,e=n.contentScrollHeight,r=n.scrollTop;y(r+100<e-t)},ref:E},l.map((function(n){var t=n.message,e=n.tags,r=n.isAction,a=n.isHistory;return o.a.createElement(Hn,{key:e.id,message:t,tags:e,isAction:r,isHistory:a})}))),o.a.createElement(Xn,{onClick:w,visible:j},"More messages below")),o.a.createElement(Tn,{onSubmit:function(t){Wn.say("#".concat("nasvay_s"),t),n(tn({message:t,tags:{id:gn()(),displayName:s,color:m}}))},isDisabled:!i||!r,isAuth:i})))},Yn=function(){var n=Object(sn.b)();return Object(a.useEffect)((function(){if(!window.location.hash){var t=localStorage.getItem("user");if(t){var e=JSON.parse(t);n(j({isAuth:!0,user:e}))}}}),[]),window.location.hash?o.a.createElement(pn,null):o.a.createElement(Qn,null)},Kn={client_id:"4e66w1po1tzf645r9vutn9qus05vg9x",redirect_uri:"https://honeykingdom.github.io/chat/",response_type:"token+id_token",scope:["openid","chat:edit","chat:read","user_blocks_read","user_blocks_edit"].join("+"),claims:JSON.stringify({id_token:{email_verified:null,picture:null,preferred_username:null}})},Zn=function(){var n=Object.entries(Kn).map((function(n){var t=Object(k.a)(n,2),e=t[0],r=t[1];return"".concat(e,"=").concat(r)})).join("&");return"".concat("https://id.twitch.tv/oauth2/authorize","?").concat(n)},$n=function(){return window.location.href=Zn(),null};function nt(){var n=Object(mn.a)(["\n  * {\n    box-sizing: border-box;\n  }\n  body {\n    margin: 0;\n    font-family: Roobert, Helvetica Neue, Helvetica, Arial, sans-serif;\n  }\n"]);return nt=function(){return n},n}var tt=Object(hn.b)(nt());function et(){var n=Object(mn.a)([""]);return et=function(){return n},n}var rt=Object(hn.b)(et());function at(){var n=Object(mn.a)([""]);return at=function(){return n},n}var ot=Object(hn.b)(at());function ct(){var n=Object(mn.a)(["\n  :root {\n    ",";\n    ",";\n  }\n  ",";\n"]);return ct=function(){return n},n}var it=Object(hn.a)(ct(),rt,ot,tt),ut=function(n){var t=n.store;return o.a.createElement(o.a.Fragment,null,o.a.createElement(sn.a,{store:t},o.a.createElement(ln.a,null,o.a.createElement(fn.c,null,o.a.createElement(fn.a,{exact:!0,path:"/chat/",component:Yn}),o.a.createElement(fn.a,{exact:!0,path:"/chat/auth",component:$n})))),o.a.createElement(it,null))},st=Object(u.e)(un,{},Object(u.d)(Object(u.a)(s.a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():function(n){return n}));i.a.render(o.a.createElement(ut,{store:st}),document.getElementById("root"))}},[[155,1,2]]]);
//# sourceMappingURL=main.7685741c.chunk.js.map